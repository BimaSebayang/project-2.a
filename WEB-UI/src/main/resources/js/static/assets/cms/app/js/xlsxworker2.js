importScripts("jszip.js");importScripts("ods.js");importScripts("xlsx.js");postMessage({t:"ready"});function ab2str(c){var d="",b=0,a=10240;for(;b<c.byteLength/a;++b){d+=String.fromCharCode.apply(null,new Uint16Array(c.slice(b*a,b*a+a)))}d+=String.fromCharCode.apply(null,new Uint16Array(c.slice(b*a)));return d}function s2ab(e){var a=new ArrayBuffer(e.length*2),c=new Uint16Array(a);for(var d=0;d!=e.length;++d){c[d]=e.charCodeAt(d)}return[c,a]}onmessage=function(b){var a;try{a=XLSX.read(ab2str(b.data),{type:"binary"})}catch(f){postMessage({t:"e",d:f.stack})}var c={t:"xlsx",d:JSON.stringify(a)};var d=s2ab(c.d)[1];postMessage(d,[d])};
var ODS={};(function make_ods(Q){var aw=function(){if(typeof XLSX!=="undefined"){return XLSX.utils}if(typeof module!=="undefined"&&typeof require!=="undefined"){try{return require("../xlsx").utils}catch(b){try{return require("./xlsx").utils}catch(a){return require("xlsx").utils}}}throw new Error("Cannot find XLSX utils")};var ap=(typeof Buffer!=="undefined");function au(a){var b="";for(var c=0;c!=a.length;++c){b+=String.fromCharCode(a[c])}return b}function aa(a){if(!a){return null}if(a.data){return a.data}if(a.asNodeBuffer&&ap){return a.asNodeBuffer().toString("binary")}if(a.asBinary){return a.asBinary()}if(a._data&&a._data.getContent){return au(Array.prototype.slice.call(a._data.getContent(),0))}return null}function V(c,a){var b=a;if(c.files[b]){return c.files[b]}b=a.toLowerCase();if(c.files[b]){return c.files[b]}b=b.replace(/\//g,"\\");if(c.files[b]){return c.files[b]}return null}function S(c,a){var b=V(c,a);if(b==null){throw new Error("Cannot find file "+a+" in zip")}return b}function an(d,a,c){if(!c){return aa(S(d,a))}if(!a){return null}try{return an(d,a)}catch(b){return null}}var ac,W;if(typeof JSZip!=="undefined"){W=JSZip}if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){if(ap&&typeof W==="undefined"){W=require("jszip")}if(typeof W==="undefined"){W=require("./jszip").JSZip}ac=require("fs")}}var ao=/\b[\w:-]+=["'][^"]*['"]/g;var Y=/<[^>]*>/g;var R=/<\w*:/,M=/<(\/?)\w+:/;function av(a,k){var e=[];var b=0,f=0;for(;b!==a.length;++b){if((f=a.charCodeAt(b))===32||f===10||f===13){break}}if(!k){e[0]=a.substr(0,b)}if(b===a.length){return e}var i=a.match(ao),h=0,d="",c="",g=0,l="",j="";if(i){for(g=0;g!=i.length;++g){j=i[g];for(f=0;f!=j.length;++f){if(j.charCodeAt(f)===61){break}}l=j.substr(0,f);c=j.substring(f+2,j.length-1);for(h=0;h!=l.length;++h){if(l.charCodeAt(h)===58){break}}if(h===l.length){e[l]=c}else{e[(h===5&&l.substr(0,5)==="xmlns"?"xmlns":"")+l.substr(h+1)]=c}}}return e}function aq(a){return a.replace(M,"<$1")}var ak={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};var ah={'"':"&quot;","'":"&apos;",">":"&gt;","<":"&lt;","&":"&amp;"};var Z="&<>'\"".split("");var ag=/&[a-z]*;/g,ai=/_x([\da-fA-F]+)_/g;function ad(b){var a=b+"";return a.replace(ag,function(c){return ak[c]}).replace(ai,function(d,c){return String.fromCharCode(parseInt(c,16))})}var am=/[&<>'"]/g,ar=/[\u0000-\u0008\u000b-\u001f]/g;function ab(b){var a=b+"";return a.replace(am,function(c){return ah[c]}).replace(ar,function(c){return"_x"+("000"+c.charCodeAt(0).toString(16)).substr(-4)+"_"})}function al(b,a){switch(b){case"1":case"true":case"TRUE":return true;default:return false}}function O(a){var b=Date.parse(a);return(b+2209161600000)/(24*60*60*1000)}function P(c){var d=0,f=0,b=false;var a=c.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a){throw new Error("|"+c+"| is not an ISO8601 Duration")}for(var e=1;e!=a.length;++e){if(!a[e]){continue}f=1;if(e>3){b=true}switch(a[e].substr(a[e].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[e].substr(a[e].length-1));case"D":f*=24;case"H":f*=60;case"M":if(!b){throw new Error("Unsupported ISO Duration Field: M")}else{f*=60}case"S":break}d+=f*parseInt(a[e],10)}return d}function U(a){if(ap&&Buffer.isBuffer(a)){return a.toString("utf8")}if(typeof a==="string"){return a}throw"badf"}var T=/<(\/?)([a-z0-9]*:|)([\w-]+)[^>]*>/mg;var aj="application/vnd.oasis.opendocument.spreadsheet";var L=function(b,e){var c=U(b);var d;var a;while((d=T.exec(c))){switch(d[3]){case"manifest":break;case"file-entry":a=av(d[0]);if(a.path=="/"&&a.type!==aj){throw new Error("This OpenDocument is not a spreadsheet")}break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:throw d}}};var af=function(b,a){return at(b.replace(/<text:s\/>/g," ").replace(/<[^>]*>/g,""))};var at=function ae(b){var h="",g=0,c=0,d=0,e=0,f=0,a=0;while(g<b.length){c=b.charCodeAt(g++);if(c<128){h+=String.fromCharCode(c);continue}d=b.charCodeAt(g++);if(c>191&&c<224){h+=String.fromCharCode(((c&31)<<6)|(d&63));continue}e=b.charCodeAt(g++);if(c<240){h+=String.fromCharCode(((c&15)<<12)|((d&63)<<6)|(e&63));continue}f=b.charCodeAt(g++);a=(((c&7)<<18)|((d&63)<<12)|((e&63)<<6)|(f&63))-65536;h+=String.fromCharCode(55296+((a>>>10)&1023));h+=String.fromCharCode(56320+(a&1023))}return h};var N=(function(){var b={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"]};return function a(t,d){var w=U(t);var i=[],s;var o;var D,n,g;var j;var k={},q=[],m={};var A,y;var v;var l,p,e;var h,B,c={s:{r:1000000,c:10000000},e:{r:0,c:0}};var z={};var C=[],r={},f=0,x=0;while((A=T.exec(w))){switch(A[3]){case"table":if(A[1]==="/"){if(c.e.c>=c.s.c&&c.e.r>=c.s.r){m["!ref"]=aw().encode_range(c)}if(C.length){m["!merges"]=C}q.push(j.name);k[j.name]=m}else{if(A[0].charAt(A[0].length-2)!=="/"){j=av(A[0]);h=B=-1;c.s.r=c.s.c=10000000;c.e.r=c.e.c=0;m={};C=[]}}break;case"table-row":if(A[1]==="/"){break}++h;B=-1;break;case"covered-table-cell":++B;break;case"table-cell":if(A[0].charAt(A[0].length-2)==="/"){v=av(A[0]);if(v["number-columns-repeated"]){B+=parseInt(v["number-columns-repeated"],10)}else{++B}}else{if(A[1]!=="/"){++B;if(B>c.e.c){c.e.c=B}if(h>c.e.r){c.e.r=h}if(B<c.s.c){c.s.c=B}if(h<c.s.r){c.s.r=h}v=av(A[0]);y={t:v["value-type"],v:null};if(v["number-columns-spanned"]||v["number-rows-spanned"]){f=parseInt(v["number-rows-spanned"],10)||0;x=parseInt(v["number-columns-spanned"],10)||0;r={s:{r:h,c:B},e:{r:h+f-1,c:B+x-1}};C.push(r)}switch(y.t){case"boolean":y.t="b";y.v=al(v["boolean-value"]);break;case"float":y.t="n";y.v=parseFloat(v.value);break;case"percentage":y.t="n";y.v=parseFloat(v.value);break;case"currency":y.t="n";y.v=parseFloat(v.value);break;case"date":y.t="n";y.v=O(v["date-value"]);y.z="m/d/yy";break;case"time":y.t="n";y.v=P(v["time-value"])/86400;break;case"string":y.t="s";break;default:throw new Error("Unsupported value type "+y.t)}}else{if(y.t==="s"){y.v=l}if(l){y.w=l}if(!(d.sheetRows&&d.sheetRows<h)){m[aw().encode_cell({r:h,c:B})]=y}y=null}}break;case"document-content":case"spreadsheet":case"scripts":case"font-face-decls":if(A[1]==="/"){if((s=i.pop())[0]!==A[3]){throw"Bad state: "+s}}else{if(A[0].charAt(A[0].length-2)!=="/"){i.push([A[3],true])}}break;case"shapes":case"frame":if(A[1]==="/"){if((s=i.pop())[0]!==A[3]){throw"Bad state: "+s}}else{if(A[0].charAt(A[0].length-2)!=="/"){i.push([A[3],false])}}break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){z[D.name]=n;if((s=i.pop())[0]!==A[3]){throw"Bad state: "+s}}else{if(A[0].charAt(A[0].length-2)!=="/"){n="";D=av(A[0]);i.push([A[3],true])}}break;case"script":break;case"automatic-styles":break;case"style":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=av(A[0]);n+=b[A[3]][o.style==="long"?1:0];break}break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=av(A[0]);n+=b[A[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].substr(-2)==="/>"){break}else{if(A[1]==="/"){switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":n+=w.slice(g,A.index);break}}else{g=A.index+A[0].length}}break;case"text-content":break;case"text-properties":break;case"body":break;case"forms":break;case"table-column":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"named-range":break;case"span":break;case"p":if(A[1]==="/"){l=af(w.slice(p,A.index),e)}else{e=av(A[0]);p=A.index+A[0].length}break;case"s":break;case"date":break;case"annotation":break;case"object":break;case"title":break;case"desc":break;case"database-ranges":break;case"database-range":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;default:if(d.WTF){throw A}}}var u={Sheets:k,SheetNames:q};return u}})();var X=function(a,b){return N(an(a,"content.xml"),b)};Q.parse_ods=X})(typeof exports!=="undefined"?exports:ODS);
importScripts("jszip.js");importScripts("ods.js");importScripts("xlsx.js");postMessage({t:"ready"});function ab2str(h){var g="",e=0,f=10240;for(;e<h.byteLength/f;++e){g+=String.fromCharCode.apply(null,new Uint16Array(h.slice(e*f,e*f+f)))}g+=String.fromCharCode.apply(null,new Uint16Array(h.slice(e*f)));return g}function s2ab(f){var b=new ArrayBuffer(f.length*2),h=new Uint16Array(b);for(var g=0;g!=f.length;++g){h[g]=f.charCodeAt(g)}return[h,b]}onmessage=function(e){var g;try{g=XLSX.read(ab2str(e.data),{type:"binary"})}catch(h){postMessage({t:"e",d:h.stack})}var j={t:"xlsx",d:JSON.stringify(g)};var i=s2ab(j.d)[1];postMessage(i,[i])};
window.ToolbarConfigurator={};(function(){function b(){this.instanceid="fte"+CKEDITOR.tools.getNextId();this.textarea=new CKEDITOR.dom.element("textarea");this.textarea.setAttributes({id:this.instanceid,name:this.instanceid,contentEditable:!0});this.editorInstance=this.buttons=null}ToolbarConfigurator.FullToolbarEditor=b;b.prototype.init=function(e){var a=this;document.body.appendChild(this.textarea.$);CKEDITOR.replace(this.instanceid);this.editorInstance=CKEDITOR.instances[this.instanceid];this.editorInstance.once("configLoaded",function(c){var d=c.editor.config;delete d.removeButtons;delete d.toolbarGroups;delete d.toolbar;ToolbarConfigurator.AbstractToolbarModifier.extendPluginsConfig(d);c.editor.once("loaded",function(){a.buttons=b.toolbarToButtons(a.editorInstance.toolbar);a.buttonsByGroup=b.groupButtons(a.buttons);a.buttonNamesByGroup=a.groupButtonNamesByGroup(a.buttons);c.editor.container.hide();"function"===typeof e&&e(a.buttons)})})};b.prototype.groupButtonNamesByGroup=function(g){var d=this;g=b.groupButtons(g);for(var a in g){g[a]=b.map(g[a],function(c){return d.getCamelCasedButtonName(c.name)})}return g};b.prototype.getGroupByName=function(i){for(var d=this.editorInstance.config.toolbarGroups||this.getFullToolbarGroupsConfig(),c=d.length,a=0;a<c;a+=1){if(d[a].name===i){return d[a]}}return null};b.prototype.getCamelCasedButtonName=function(g){var d=this.editorInstance.ui.items,a;for(a in d){if(d[a].name==g){return a}}return null};b.prototype.getFullToolbarGroupsConfig=function(g){g=!0===g?!0:!1;for(var f=[],a=this.editorInstance.toolbar,o=a.length,d=0;d<o;d+=1){var c=a[d],e={};"string"!=typeof c.name?g&&f.push("/"):(e.name=c.name,c.groups&&(e.groups=Array.prototype.slice.call(c.groups)),f.push(e))}return f};b.filter=function(k,f){for(var c=k&&k.length?k.length:0,a=[],d=0;d<c;d+=1){f(k[d])&&a.push(k[d])}return a};b.map=function(k,f){var c;if(CKEDITOR.tools.isArray(k)){c=[];for(var a=k.length,d=0;d<a;d+=1){c.push(f(k[d]))}}else{for(a in c={},k){c[a]=f(k[a])}}return c};b.groupButtons=function(m){for(var f={},c=m.length,a=0;a<c;a+=1){var e=m[a],d=e.toolbar.split(",")[0];f[d]=f[d]||[];f[d].push(e)}return f};b.toolbarToButtons=function(i){for(var d=[],c=i.length,a=0;a<c;a+=1){"object"==typeof i[a]&&(d=d.concat(b.groupToButtons(i[a])))}return d};b.createToolbarButton=function(k){var f=new CKEDITOR.dom.element("a"),c=b.createIcon(k.name,k.icon,k.command);f.setStyle("float","none");f.addClass("cke_"+("rtl"==CKEDITOR.lang.dir?"rtl":"ltr"));if(k instanceof CKEDITOR.ui.button){f.addClass("cke_button"),f.addClass("cke_toolgroup"),f.append(c)}else{if(CKEDITOR.ui.richCombo&&k instanceof CKEDITOR.ui.richCombo){var c=new CKEDITOR.dom.element("span"),a=new CKEDITOR.dom.element("span"),d=new CKEDITOR.dom.element("span");f.addClass("cke_combo_button");c.addClass("cke_combo_text");c.addClass("cke_combo_inlinelabel");c.setText(k.label);a.addClass("cke_combo_open");d.addClass("cke_combo_arrow");a.append(d);f.append(c);f.append(a)}}return f};b.createIcon=function(i,d,c){var a=CKEDITOR.skin.getIconStyle(i,"rtl"==CKEDITOR.lang.dir),a=(a=a||CKEDITOR.skin.getIconStyle(d,"rtl"==CKEDITOR.lang.dir))||CKEDITOR.skin.getIconStyle(c,"rtl"==CKEDITOR.lang.dir);d=new CKEDITOR.dom.element("span");d.addClass("cke_button_icon");d.addClass("cke_button__"+i+"_icon");d.setAttribute("style",a);d.setStyle("float","none");return d};b.createButton=function(i,d){var c=new CKEDITOR.dom.element("button");c.addClass("button-a");c.setAttribute("type","button");if("string"==typeof d){d=d.split(" ");for(var a=d.length;a--;){c.addClass(d[a])}}c.setHtml(i);return c};b.groupToButtons=function(k){for(var f=[],c=(k=k.items)?k.length:0,a=0;a<c;a+=1){var d=k[a];if(d instanceof CKEDITOR.ui.button||CKEDITOR.ui.richCombo&&d instanceof CKEDITOR.ui.richCombo){d.$=b.createToolbarButton(d),f.push(d)}}return f}})();
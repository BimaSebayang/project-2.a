"function"!=typeof Object.create&&function(){var a=function(){};Object.create=function(b){if(1<arguments.length){throw Error("Second argument not supported")}if(null===b){throw Error("Cannot set a null [[Prototype]]")}if("object"!=typeof b){throw TypeError("Argument must be an object")}a.prototype=b;return new a}}();CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(a){a.addMode("wysiwyg",function(b){var c=CKEDITOR.dom.element.createFromHtml('\x3cdiv class\x3d"cke_wysiwyg_div cke_reset" hidefocus\x3d"true"\x3e\x3c/div\x3e');a.ui.space("contents").append(c);c=a.editable(c);c.detach=CKEDITOR.tools.override(c.detach,function(d){return function(){d.apply(this,arguments);this.remove()}});a.setData(a.getData(1),b);a.fire("contentDom")});a.dataProcessor.toHtml=function(b){return b};a.dataProcessor.toDataFormat=function(b){return b}}});Object.keys||(Object.keys=function(){var c=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),a="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),b=a.length;return function(g){if("object"!==typeof g&&("function"!==typeof g||null===g)){throw new TypeError("Object.keys called on non-object")}var f=[],d;for(d in g){c.call(g,d)&&f.push(d)}if(e){for(d=0;d<b;d++){c.call(g,a[d])&&f.push(a[d])}}return f}}());(function(){function a(b,c){this.cfg=c||{};this.hidden=!1;this.editorId=b;this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor;this.actualConfig=this.originalConfig=this.mainContainer=null;this.isEditableVisible=this.waitForReady=!1;this.toolbarContainer=null;this.toolbarButtons=[]}ToolbarConfigurator.AbstractToolbarModifier=a;a.prototype.setConfig=function(b){this._onInit(void 0,b,!0)};a.prototype.init=function(b){var c=this;this.mainContainer=new CKEDITOR.dom.element("div");if(null!==this.fullToolbarEditor.editorInstance){throw"Only one instance of ToolbarModifier is allowed"}this.editorInstance||this._createEditor(!1);this.editorInstance.once("loaded",function(){c.fullToolbarEditor.init(function(){c._onInit(b);if("function"==typeof c.onRefresh){c.onRefresh()}},c.editorInstance.config)});return this.mainContainer};a.prototype._onInit=function(h,g){this.originalConfig=this.editorInstance.config;this.actualConfig=g?JSON.parse(g):JSON.parse(JSON.stringify(this.originalConfig));if(!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var f=this.actualConfig,k=this.editorInstance.toolbar,b=[],q=k.length,d=0;d<q;d++){var c=k[d];"string"==typeof c?b.push(c):b.push({name:c.name,groups:c.groups?c.groups.slice():[]})}f.toolbarGroups=b}"function"===typeof h&&h(this.mainContainer)};a.prototype._createModifier=function(){this.mainContainer.addClass("unselectable");this.modifyContainer&&this.modifyContainer.remove();this.modifyContainer=new CKEDITOR.dom.element("div");this.modifyContainer.addClass("toolbarModifier");this.mainContainer.append(this.modifyContainer);return this.mainContainer};a.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")};a.prototype._hideEditable=function(){var b=this.getEditableArea();this.isEditableVisible=!1;this.lastEditableAreaHeight=b.getStyle("height");b.setStyle("height","0")};a.prototype._showEditable=function(){this.isEditableVisible=!0;this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")};a.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()};a.prototype._refreshEditor=function(){function g(){b.editorInstance.destroy();b._createEditor(!0,b.getActualConfig());b.waitForReady=!1}var b=this,c=this.editorInstance.status;this.waitForReady||("unloaded"==c||"loaded"==c?(this.waitForReady=!0,this.editorInstance.once("instanceReady",function(){g()},this)):g())};a.prototype._createEditor=function(b,c){function e(){}var d=this;this.editorInstance=CKEDITOR.replace(this.editorId);this.editorInstance.on("configLoaded",function(){var f=d.editorInstance.config;c&&CKEDITOR.tools.extend(f,c,!0);a.extendPluginsConfig(f)});this.editorInstance.on("uiSpace",function(f){"top"!=f.data.space&&f.stop()},null,null,-999);this.editorInstance.once("loaded",function(){var f=d.editorInstance.ui.instances,g;for(g in f){f[g]&&(f[g].click=e,f[g].onClick=e)}d.isEditableVisible||d._hideEditable();d.currentActive&&d.currentActive.name&&d._highlightGroup(d.currentActive.name);d.hidden?d.hideUI():d.showUI();if(b&&"function"===typeof d.onRefresh){d.onRefresh()}})};a.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))};a.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div");this.toolbarContainer.addClass("toolbar");for(var b=this.toolbarButtons.length,c=0;c<b;c+=1){this._createToolbarBtn(this.toolbarButtons[c])}}};a.prototype._createToolbarBtn=function(b){var c=ToolbarConfigurator.FullToolbarEditor.createButton("string"===typeof b.text?b.text:b.text.inactive,b.cssClass);this.toolbarContainer.append(c);c.data("group",b.group);c.addClass(b.position);c.on("click",function(){b.clickCallback.call(this,c,b)},this);return c};a.prototype._fixGroups=function(i){i=i.toolbarGroups||[];for(var b=i.length,d=0;d<b;d+=1){var c=i[d];"/"==c?(c=i[d]={},c.type="separator",c.name="separator"+CKEDITOR.tools.getNextNumber()):(c.groups=c.groups||[],-1==CKEDITOR.tools.indexOf(c.groups,c.name)&&(this.editorInstance.ui.addToolbarGroup(c.name,c.groups[c.groups.length-1],c.name),c.groups.push(c.name)),this._fixSubgroups(c))}};a.prototype._fixSubgroups=function(i){i=i.groups;for(var b=i.length,d=0;d<b;d+=1){var c=i[d];i[d]={name:c,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(c,this.fullToolbarEditor)}}};a.stringifyJSONintoOneLine=function(g,e){e=e||{};var b=JSON.stringify(g,null,""),b=b.replace(/\n/g,"");e.addSpaces&&(b=b.replace(/(\{|:|,|\[|\])/g,function(c){return c+" "}),b=b.replace(/(\])/g,function(c){return" "+c}));e.noQuotesOnKey&&(b=b.replace(/"(\w*)":/g,function(c,d){return d+":"}));e.singleQuotes&&(b=b.replace(/\"/g,"'"));return b};a.prototype.hideUI=function(){this.hidden=!0;this.mainContainer.hide();this.editorInstance.container&&this.editorInstance.container.hide()};a.prototype.showUI=function(){this.hidden=!1;this.mainContainer.show();this.editorInstance.container&&this.editorInstance.container.show()};a.extendPluginsConfig=function(c){var b=c.extraPlugins;c.extraPlugins=(b?b+",":"")+"toolbarconfiguratorarea"}})();